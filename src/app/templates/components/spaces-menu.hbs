<div class="secondary-sidebar-header">
  <div class="title">
    {{t 'components.spacesMenu.title'}}
  </div>
  <figure class="icon" {{action 'startCreateSpace'}}>
    {{one-icon icon='space-add'}}
    <figcaption>{{t 'components.spacesMenu.create'}}</figcaption>
  </figure>
  <figure class="icon" {{action 'startJoinSpace'}}>
    {{one-icon icon='join'}}
    <figcaption>{{t 'components.spacesMenu.join'}}</figcaption>
  </figure>
</div>

<ul class="spaces-list">
  {{#each validSpacesSorted as |space|}}
    {{spaces-menu-item space=space isExpanded=(eq activeSpace.id space.id)
      openSettingsModal='openSettingsModal' openSubmenuEntry='openSubmenuEntry'
      setAsHome='setAsHome' collapseAllSpaces='collapseAllSpaces'}}
  {{/each}}
</ul>

{{!-- modals --}}

{{!-- TODO: refactor: make a generic modals components for: enter single line, question --}}

{{!-- CREATE SPACE --}}

{{#bs-modal openedAction='createSpaceModalOpened' open=isCreatingSpace body=false footer=false
    title=(t "components.spacesMenu.createModal.title")
    id="create-space"}}
  {{#bs-modal-body}}
    <div class="control-label">
      {{t 'components.spacesMenu.createModal.enterName'}}
    </div>

    {{input type="text" value=newSpaceName autofocus=true
      class="form-control"
      enter=(if (and newSpaceName (not isSavingSpace)) "submitCreateSpace")}}
  {{/bs-modal-body}}
  {{#bs-modal-footer as |footer|}}
    {{#spin-button-onedata
      action=(unless isSavingSpace "submitCreateSpace")
      class="btn btn-primary no-outline" spinnerColor="#fff"
      inFlight=isSavingSpace disabled=(or (unless newSpaceName true) isSavingSpace)}}
      {{t "common.modal.create"}}
    {{/spin-button-onedata}}

    {{#bs-button action=(action "close" target=footer) type="default" disabled=isSavingSpace
      class="no-outline"}}
      {{t "common.modal.cancel"}}
    {{/bs-button}}
  {{/bs-modal-footer}}
{{/bs-modal}}

{{!-- JOIN SPACE --}}

{{#bs-modal open=isJoiningSpace body=false footer=false
    title=(t "components.spacesMenu.joinModal.title")
    id="join-space"}}
  {{#bs-modal-body}}
    {{#bs-form action=(action "submitJoinSpace") model=this}}
      {{bs-form-element controlType="text" property="joinSpaceToken" autofocus=true
        label=(t 'components.spacesMenu.joinModal.label')}}
    {{/bs-form}}
  {{/bs-modal-body}}
  {{#bs-modal-footer as |footer|}}
    {{#spin-button-onedata buttonType="submit"
      class="btn btn-primary no-outline" spinnerColor="#fff"
      inFlight=isJoiningSpaceWorking disabled=(unless joinSpaceToken true)}}
      {{t "common.modal.join"}}
    {{/spin-button-onedata}}
  {{/bs-modal-footer}}
{{/bs-modal}}

{{!-- space operations --}}

{{!-- RENAME SPACE --}}

{{modals/rename-modal model=modalSpace open=isRenameModalOpened modalId="rename-space"
  title=(t "components.spacesMenu.renameModal.title")
  label=(t 'components.spacesMenu.renameModal.label')}}

{{!-- LEAVE SPACE --}}

{{#bs-modal open=isLeaveModalOpened body=false footer=false
    title=(t "components.spacesMenu.leaveModal.title")
    submitAction="submitLeaveSpace" id="leave-space"}}
  {{#bs-modal-body}}
    {{t 'components.spacesMenu.leaveModal.label' spaceName=modalSpace.name}}
  {{/bs-modal-body}}
  {{#bs-modal-footer as |footer|}}
    {{#bs-button buttonType="submit" type="primary"}}
      {{t "common.modal.yes"}}
    {{/bs-button}}
    {{#bs-button action=(action "close" target=footer) type="default"}}
      {{t "common.modal.no"}}
    {{/bs-button}}
  {{/bs-modal-footer}}
{{/bs-modal}}

{{!-- TODO: use modals/remove-modal component --}}
{{!-- REMOVE SPACE --}}

{{#bs-modal open=isRemoveModalOpened body=false footer=false
    title=(t "components.spacesMenu.removeModal.title")
    submitAction="submitRemoveSpace" id="remove-space"}}
  {{#bs-modal-body}}
    {{t 'components.spacesMenu.removeModal.label' spaceName=modalSpace.name}}
  {{/bs-modal-body}}
  {{#bs-modal-footer as |footer|}}
    {{#bs-button buttonType="submit" type="primary"}}
      {{t "common.modal.yes"}}
    {{/bs-button}}
    {{#bs-button action=(action "close" target=footer) type="default"}}
      {{t "common.modal.no"}}
    {{/bs-button}}
  {{/bs-modal-footer}}
{{/bs-modal}}
